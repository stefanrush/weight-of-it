<!-- doing this in erb because I don't know how to do it in haml -->
<script>
  $(function() {
    window.app = new WOI.Routers.App({
      libraries: [
        <% cache 'v1', @libraries do %>
          <% @libraries.each do |library| %>
            <% cache 'v1', library do %>
              <%= library.app_json %>,
            <% end %>
          <% end %>
        <% end %>
      ],
      categories: [
        <% cache 'v1', @categories do %>
          <% @categories.each do |category| %>
            <% cache 'v1', category do %>
              <%= category.app_json %>,
            <% end %>
          <% end %>
        <% end %>
      ],
      perPage: <%= @per_page %>
    });
    Backbone.history.start({ pushState: true });
  });
</script>
